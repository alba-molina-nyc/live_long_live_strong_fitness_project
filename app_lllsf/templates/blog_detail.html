{% extends 'base.html' %}

{% block content %}
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card">
          <div class="card-header">{{ blog_detail.title }}</div>
          <div class="card-body">
            <p>{{ blog_detail.description }}</p>
            <p><strong>Author:</strong> {{ blog_detail.author }}</p>
            <p><strong>Category:</strong> {{ blog_detail.get_category_display }}</p>
            <img src="{{ blog_detail.image_1.url }}" alt="{{ blog_detail.title }}" class="img-fluid my-3">
            {% if blog_detail.paragraph_1 %}
              <p>{{ blog_detail.paragraph_1 }}</p>
            {% endif %}
            {% if blog_detail.paragraph_2 %}
              <p>{{ blog_detail.paragraph_2 }}</p>
            {% endif %}
            {% if blog_detail.paragraph_3 %}
              <p>{{ blog_detail.paragraph_3 }}</p>
            {% endif %}
            {% if blog_detail.paragraph_4 %}
              <p>{{ blog_detail.paragraph_4 }}</p>
            {% endif %}
            {% if blog_detail.paragraph_5 %}
              <p>{{ blog_detail.paragraph_5 }}</p>
            {% endif %}
            {% if blog_detail.paragraph_6 %}
              <p>{{ blog_detail.paragraph_6 }}</p>
            {% endif %}
            {% if blog_detail.paragraph_7 %}
              <p>{{ blog_detail.paragraph_7 }}</p>
            {% endif %}
            {% if blog_detail.paragraph_8 %}
              <p>{{ blog_detail.paragraph_8 }}</p>
            {% endif %}
            {% if blog_detail.paragraph_9 %}
              <p>{{ blog_detail.paragraph_9 }}</p>
            {% endif %}
          </div>
        </div>

        <h3 class="mt-4">{{ comments.count }} Comments</h3>
        {% for comment in comments %}
          <div class="card my-3">
            <div class="card-body">
              <h5 class="card-title">{{ comment.name }}</h5>
              <p class="card-text">{{ comment.comment_body }}</p>
              <small>{{ comment.date_posted }}</small>
            </div>
          </div>
          {% if comment.replies %}
            {% for reply in comment.replies.all %}
              <div class="card my-3 ml-5">
                <div class="card-body">
                  <h5 class="card-title">{{ reply.name }}</h5>
                  <p class="card-text">{{ reply.comment_body }}</p>
                  <small>{{ reply.date_posted }}</small>
                </div>
              </div>
            {% endfor %}
          {% endif %}
        {% empty %}
          <p>No comments yet.</p>
        {% endfor %}

<!-- Leave a Comment -->
<div class="card my-4">
  <h5 class="card-header">Leave a Comment:</h5>
  <div class="card-body">
    <form method="POST" action="{% url 'blog_detail' blog_detail.id %}">
      {% csrf_token %}
      <div class="form-group">
        <label for="name">Name:</label>
        <input type="text" class="form-control" id="name" name="name">
      </div>
      <div class="form-group">
        <label for="email">Email:</label>
        <input type="email" class="form-control" id="email" name="email">
      </div>
      <div class="form-group">
        <label for="comment">Comment:</label>
        <textarea class="form-control" rows="3" id="comment" name="comment"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>
  </div>
</div>
{% endblock %}
